<!DOCTYPE html>
<html lang="bn">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ড্যাশবোর্ড | PanelShop Pro</title>
    <script src="https://www.gstatic.com/firebasejs/8.10.0/firebase-app.js"></script>
    <script src="https://www.gstatic.com/firebasejs/8.10.0/firebase-auth.js"></script>
    <script src="https://www.gstatic.com/firebasejs/8.10.0/firebase-firestore.js"></script>
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Hind+Siliguri:wght@400;600;700&display=swap');
        body { font-family: 'Hind Siliguri', sans-serif; bg-[#0b0f1a]; }
    </style>
</head>
<body class="bg-[#0b0f1a] text-white overflow-x-hidden">

    <nav class="bg-[#161b2c] border-b border-slate-800 p-4 sticky top-0 z-50 shadow-lg">
        <div class="container mx-auto flex justify-between items-center">
            <h1 class="text-2xl font-bold text-blue-500 tracking-tighter">PANEL<span class="text-white">SHOP</span></h1>
            
            <div class="flex items-center gap-4">
                <div class="text-right hidden sm:block">
                    <p id="nav-user-name" class="text-sm font-bold">অপেক্ষা করুন...</p>
                    <p id="nav-user-email" class="text-xs text-slate-400">লোড হচ্ছে...</p>
                </div>
                <button onclick="handleLogout()" class="bg-rose-600/10 hover:bg-rose-600 text-rose-500 hover:text-white px-4 py-2 rounded-xl border border-rose-600/20 transition-all flex items-center gap-2 font-bold">
                    <i class="fas fa-sign-out-alt"></i>
                    <span class="hidden sm:inline">লগ আউট</span>
                </button>
            </div>
        </div>
    </nav>

    <main class="container mx-auto p-4 sm:p-6 lg:p-10">
        <div class="grid grid-cols-1 lg:grid-cols-3 gap-6">
            
            <div class="bg-gradient-to-br from-blue-600 to-blue-800 p-8 rounded-3xl shadow-2xl shadow-blue-900/20 relative overflow-hidden group">
                <div class="relative z-10">
                    <p class="text-blue-100 text-lg opacity-80">বর্তমান ব্যালেন্স</p>
                    <h2 id="user-balance" class="text-5xl font-extrabold mt-2">৳ 0.00</h2>
                    <div class="mt-8 flex gap-3">
                        <a href="add-money.html" class="bg-white text-blue-600 px-6 py-3 rounded-2xl font-bold flex items-center gap-2 hover:bg-blue-50 transition-all">
                            <i class="fas fa-plus-circle"></i> টাকা যোগ করুন
                        </a>
                    </div>
                </div>
                <i class="fas fa-wallet absolute -right-4 -bottom-4 text-9xl text-white/10 group-hover:scale-110 transition-transform"></i>
            </div>

            <div class="lg:col-span-2 bg-[#161b2c] p-8 rounded-3xl border border-slate-800">
                <h3 class="text-xl font-bold mb-6 flex items-center gap-2">
                    <i class="fas fa-user-shield text-blue-500"></i> আপনার প্রোফাইল তথ্য
                </h3>
                <div class="grid grid-cols-1 sm:grid-cols-2 gap-6">
                    <div class="bg-[#0b0f1a] p-4 rounded-2xl border border-slate-800">
                        <p class="text-slate-500 text-xs uppercase tracking-wider mb-1">পুরো নাম</p>
                        <p id="profile-name" class="font-bold text-lg text-slate-200">-</p>
                    </div>
                    <div class="bg-[#0b0f1a] p-4 rounded-2xl border border-slate-800">
                        <p class="text-slate-500 text-xs uppercase tracking-wider mb-1">মোবাইল নম্বর</p>
                        <p id="profile-phone" class="font-bold text-lg text-slate-200">-</p>
                    </div>
                    <div class="bg-[#0b0f1a] p-4 rounded-2xl border border-slate-800">
                        <p class="text-slate-500 text-xs uppercase tracking-wider mb-1">ইমেইল</p>
                        <p id="profile-email" class="font-bold text-lg text-slate-200">-</p>
                    </div>
                    <div class="bg-[#0b0f1a] p-4 rounded-2xl border border-slate-800">
                        <p class="text-slate-500 text-xs uppercase tracking-wider mb-1">ইউজার আইডি</p>
                        <p id="profile-id" class="font-mono text-xs text-blue-400 mt-1 uppercase">-</p>
                    </div>
                </div>
            </div>

        </div>

        <div class="mt-10 grid grid-cols-2 md:grid-cols-4 gap-4">
            <button class="bg-[#161b2c] p-6 rounded-3xl border border-slate-800 hover:border-blue-500 transition-all group text-center">
                <i class="fas fa-shopping-cart text-3xl mb-3 text-slate-500 group-hover:text-blue-500"></i>
                <p class="font-bold block">শপ করুন</p>
            </button>
            <button class="bg-[#161b2c] p-6 rounded-3xl border border-slate-800 hover:border-blue-500 transition-all group text-center">
                <i class="fas fa-history text-3xl mb-3 text-slate-500 group-hover:text-blue-500"></i>
                <p class="font-bold block">অর্ডার হিস্ট্রি</p>
            </button>
            <button class="bg-[#161b2c] p-6 rounded-3xl border border-slate-800 hover:border-blue-500 transition-all group text-center">
                <i class="fas fa-headset text-3xl mb-3 text-slate-500 group-hover:text-blue-500"></i>
                <p class="font-bold block">সাপোর্ট</p>
            </button>
            <button onclick="handleLogout()" class="bg-[#161b2c] p-6 rounded-3xl border border-slate-800 hover:border-rose-500 transition-all group text-center">
                <i class="fas fa-power-off text-3xl mb-3 text-slate-500 group-hover:text-rose-500"></i>
                <p class="font-bold block">লগ আউট</p>
            </button>
        </div>
    </main>

    <script>
        // আপনার আসল Firebase কনফিগারেশন
        const firebaseConfig = {
            apiKey: "AIzaSyBx8hSPYxI34ZTaHs9ScdA8pGz9rO-o-O8",
            authDomain: "panelshop-71ed8.firebaseapp.com",
            databaseURL: "https://panelshop-71ed8-default-rtdb.firebaseio.com",
            projectId: "panelshop-71ed8",
            storageBucket: "panelshop-71ed8.appspot.com",
            messagingSenderId: "741029675696",
            appId: "1:741029675696:web:86331dc6ab82551d86f175",
            measurementId: "G-3V79YMK021"
        };
        
        firebase.initializeApp(firebaseConfig);
        const auth = firebase.auth();
        const db = firebase.firestore();

        // ইউজার লগইন চেক এবং ডাটা লোড করা
        auth.onAuthStateChanged((user) => {
            if (user) {
                const uid = user.uid;
                localStorage.setItem("userId", uid); // পেমেন্টের জন্য সেভ করে রাখা

                // Firestore থেকে তথ্য আনা
                db.collection("users").doc(uid).get().then((doc) => {
                    if (doc.exists) {
                        const userData = doc.data();
                        
                        // ড্যাশবোর্ডে ডাটা আপডেট করা
                        document.getElementById('nav-user-name').innerText = userData.name || "ইউজার";
                        document.getElementById('nav-user-email').innerText = user.email;
                        document.getElementById('user-balance').innerText = "৳ " + (userData.balance || 0).toFixed(2);
                        
                        document.getElementById('profile-name').innerText = userData.name;
                        document.getElementById('profile-phone').innerText = userData.phone || "সেট করা নেই";
                        document.getElementById('profile-email').innerText = user.email;
                        document.getElementById('profile-id').innerText = uid;
                    }
                }).catch((error) => {
                    console.log("Error getting document:", error);
                });

            } else {
                // লগইন না থাকলে লগইন পেজে পাঠিয়ে দেবে
                window.location.href = "login.html";
            }
        });

        // লগআউট ফাংশন
        function handleLogout() {
            if(confirm("আপনি কি নিশ্চিতভাবে লগআউট করতে চান?")) {
                auth.signOut().then(() => {
                    localStorage.removeItem("userId");
                    window.location.href = "login.html";
                }).catch((error) => {
                    alert("লগআউট করতে সমস্যা হয়েছে!");
                });
            }
        }
    </script>
</body>
</html>
